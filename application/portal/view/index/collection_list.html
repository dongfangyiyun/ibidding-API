{include file="/index/top" /}
<style>
    .collection-list {
        width: 166px;
        margin: 5px;
    }

    .collection-list:hover .collection-twobtn {
        display: inline-block
    }

    .collection-list-img {
        height: 164px;
        width: 164px;
    }

    .collection-twobtn {
        position: absolute;
        display: none;
        top: 154px;
        overflow: hidden;
        width: 100%;
        text-align: center
    }

    .collection-twobtn>div {
        width: 48%;
        padding: 4px 0;
    }

    .collection-greyback {
        background: #333;
        opacity: 0.4;
        height: 100%;
        position: absolute;
        width: 100%;
    }

    .collection-ifbtn {
        height: 100%;
        width: 100%;
        position: absolute
    }

    .collection-ond {
        position: absolute;
        width: 100%;
        z-index: 99;
        text-align: center;
        top: 115px;
    }

    .collection-true {
        width: 56px;
        height: 26px;
        line-height: 26px;
        border-radius: 3px;
        margin: 13px;
    }

    .collection-false {
        width: 56px;
        height: 26px;
        line-height: 26px;
        border-radius: 3px;
        margin: 13px
    }
    .collection_null_img{
        margin-top:100px; 
    }
    .collection_null_text{
        width: 100%;
        position: absolute;
         top: 152px;
         color: #666;
    }
    .collection_null_box{
        margin-bottom: 150px;
    }
    .collection-page{height:30px;line-height: 30px;width: 30px;text-align: center;}

.collection-active{background: #03a9f4 !important;color: #fff!important;}
.collection-page:hover{background: #03a9f4 !important;color: #fff!important}

.current {
        background: #108ee9!important;
    }
</style>
</head>

<body>
    {include file="/index/header" /}
    <div id="app">
    <div class="w1200 margin-tt-15 over  black-text">
            <div class="left">
                    <!-- 个人信息卡 -->
                    <div class="card-title-wrap">
                        <img  src="__static__/portal/img/title-back.png" class="responsive-img">
                        <div class="margin-10 over card-text-wrap">
                            <div class="ridius-img left margin-15">
                                <img :src="user.avatar" alt="">
                            </div>
                            <div class="left margin-top-15">
                                <div class="font-size-18 margin-top-15 white-text"  v-text="user.nick_name || user.mobile"></div>
                                <div class="blue lighten-1 margin-top-5" style="border-radius: 4px;padding: 2px 4px;">
                                    <img src="__static__/portal/img/lr.png" alt="">
                                    <span class="font-size-12 white-text" v-text="level"></span>
                                </div>
                            </div>
                        </div>
                        <div class="rate-line font-size-12 blue-text text-lighten-5">
                            <div class="rataing-nember  margin-15" v-text=" '成长值  ' + score"></div>
                            <div class="ratas-nember right"></div>	
                        </div>
                    </div>
                    <div class="white grey-text text-darken-3 margin-top-15" style="border-radius: 5px">
                       <!--  <div class="card-right-nav-box  margin-10 padding-tt-10" style="border: none">
                            <div class="card-right-nav">
                                <div class="font-size-18 over margin-tt-10">
                                    <i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
                                    <span class="left margin-top-5">交易管理</span>
                                </div>
                                <ul class="card-right-nav-ul">
                                    <li class="margin-tt-13" @click="goto('cart_list')">购物车</li>
                                    <li class="margin-tt-13" @click="goto('order_list')">我的订单</li>
                                    <li class="margin-tt-13" @click="goto('comment_list')">我的评价</li>
                                </ul>
                            </div>
                        </div> -->
                        <div class="card-right-nav-box  margin-10 padding-tt-10">
                            <div class="card-right-nav">
                                <div class="font-size-18 over margin-tt-10">
                                        <i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
                                    <span class="left margin-top-5">账号管理</span>
                                </div>
                                <ul class="card-right-nav-ul">
                                     <li class="margin-tt-13" @click="goto('setting')">个人信息</li>
                                   <!--  <li class="margin-tt-13" @click="goto('account')">账号安全</li>
                                    <li class="margin-tt-13" @click="goto('idcard_auth')" >实名认证</li> -->
                                    <!-- <li class="margin-tt-13" @click="goto('address_list')">地址管理</li> -->
                                    <li class="margin-tt-13"  @click="goto('collection_list')">我的收藏</li>
                                    <li class="margin-tt-13"  @click="goto('comment')">我的推送</li>
                                    <!-- <li class="margin-tt-13"  @click="goto('collection_list')">我的消息</li> -->
                                    <li class="margin-tt-13"  @click="goto('level')">成长值<span class="blue-text text-lighten-1" v-text="'('+score+')'"></span></li>
                                    <!-- <li class="margin-tt-13"  @click="goto('bind')">第三方账户</li> -->
                                </ul>
                            </div>
                        </div>
                       <!--  <div class="card-right-nav-box margin-10 padding-tt-10">
                            <div class="card-right-nav">
                                <div class="font-size-18 over margin-tt-10">
                                        <i class="iconfont icon-icon_order left text-lighten-1" style="font-size:24px; margin-right: 5px;height: 30px;line-height: 30px;"></i>
                                    <span class="left margin-top-5">资产管理</span>
                                </div>
                                <ul class="card-right-nav-ul">
                                    <li class="margin-tt-13" @click="goto('wallet')">我的钱包</li>
                                    <li class="margin-tt-13" @click="goto('bankcard_list')">我的银行卡</li>
                                    <li class="margin-tt-13" @click="goto('my_coupon_list')">我的优惠券<span class="blue-text text-lighten-2"></span></li>
                                </ul>
                            </div>
                        </div> -->
                    </div>
                </div> 	
        <div class="right right-content">
            <div class="padding-15 white">
                <div class="margin-5 font-size-16 grey-text text-darken-3 padding-tt-15 border-btn">
                    我的收藏
                </div>
                <div v-if="haveNoData" class="over margin-btn-15">
                    <div class="center relative margin-btn-10">
                            <div class="collection_null_text">暂无数据</div>
                            <img  src="__static__/portal/img/404.png" alt="" class="responsive-img collection_null_img"><br>
                     </div>
                </div>
                <div v-else class="over">
                    <div class="relative border-grey" v-for="(collection,key) in collections" :key="key" style="margin-bottom: 10px;">
                        <div class="padding-10">
                            <div class="font-size-14" v-text="(currentPage-1)*page_size+key+1+'. '+collection.bid_info.title" style="height: 42px;"></div>
                            <div class="red-text">
                                <span class="" v-text="'【'+collection.bid_info.type+'】'"></span>
                                <span class="font-size-10 grey-text line-th" v-text="'收藏时间：'+collection.create_time"></span>
                                <span style="float: right;cursor: pointer;" @click="cancalCollection(collection)" class="aui-iconfont iconfont icon-shanchu aui-pull-right"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="fen-page" style="margin-top:24px;text-align:left;margin-left:23px;margin-bottom:12px;" v-if="page_count > page_size">
                        <span v-for="(page,key) in pages" @click="getPage(page)">
                            <span v-if="currentPage == page" class="current" v-text="page"></span>
                            <span v-else v-text="page"></span>
                        </span>
                    </div>
            </div>
        </div>
    </div>
</div>
    {include file="index/footer" /}
    <script>
        var app = new Vue({
            el: '#app',
            data: {
                currentPage: parseInt(querystring.currentPage) || 1, //当前页
                currentPageSize:5, //当前页容量
                total: 0, //总页数
                activeFooterIndex: 4,
                title: '我的收藏',
                user: user,
                haveNoData: false,
                level: '',
                score: '',
                pages: [],
                page_count:'',
                page_size:'',
                collections: [],
                cancal:'',
                guessGoods:'',
            },
            methods: {
                authentication: function () {
                    httpRequest('POST', 'api_query/users/auth',{},function (resp) {
                        var status = resp.data.status;
                        if (status == 0 || status == 2) {
                            goto('idcard_auth', {status: status, id: resp.data.id});
                        } else if (status == 1 || status == 3) {
                            goto('idcard_info');
                        }
                    })
                },
                changeCollect:function (status) {
                    this.cancal = status;
                },
                cancalCollection: function (collection){
                    httpRequest('POST', 'api_bids/bid_collections/cancel',{
                        bid_id:collection.bid_id
                    },function (resp){
                        layer.msg(resp.msg)
                        setTimeout(function () {
                            location.reload();
                        }, 500)
                    })
                },
                joinCart:function (argument) {
                    // body...
                },
                // 跳页
                handleCurrentChange:function(val) {
                  this.currentPage = val;
                  this.loadTableData();
                },
                // 改变页容量
                handleSizeChange:function(val) {
                  this.currentPageSize = val;
                  this.loadTableData();
                },
                getPage: function (data) {
                    this.currentPage = data;
                    app.pages = []
                    app.collections = []
                    loadOrders(data)
                }
            },
            mounted: function () {
                    httpRequest('POST', 'api_query/users/asset',{},function (resp) {
                            app.level = resp.data.level;
                            app.score = resp.data.score;
                        })
                        httpRequest('POST', 'api_bids/bid_collections/lists',{},function (resp){
                            if (resp.data.length > 0) {
                                var data_count = resp.page.data_count;
                                app.haveNoData = false;
                                app.page_count = data_count;
                                app.page_size = resp.page.page_limit;
                                pagesStatus(data_count);
                                resp.data.forEach(function (item) {
                                    app.collections.push(item);
                                })
                            } else {
                                app.haveNoData = true;
                            }
                            app.total = resp.page.data_count || 0;
                },{
                                'page-num':this.currentPage,
                                'page-limit': this.currentPageSize
                            })
            }
        })
        loadOrders = function(page){
            httpRequest('POST', 'api_bids/bid_collections/lists',{},function (resp){
                if (resp.data.length > 0) {
                    var data_count = resp.page.data_count;
                    app.haveNoData = false;
                    app.page_count = data_count;
                    app.page_size = resp.page.page_limit;
                    pagesStatus(data_count);
                    resp.data.forEach(function (item) {
                        app.collections.push(item);
                    })
                    if (resp.data.length == 10) {
                        page++;
                        document.body.onscroll = scrollEvent;
                    } else {
                        document.body.onscroll = null;
                    }
                } else {
                    app.haveNoData = true;
                }
                app.total = resp.page.data_count || 0;
                //猜你喜欢
                },{
                'page-num': page,
                'page-limit': app.currentPageSize
            })
        }
        pagesStatus = function (data) {
            app.pages = []
            var page_li = Math.ceil(data / 5);
            if (!data) {
                page_li = 0;
                return;
            }
            for (var index = 1; index < page_li + 1; index++) {
                app.pages.push(index);
            };
        }
    </script>
</body>

</html>
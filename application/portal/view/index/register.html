{include file="/index/top" /}
<script src="__static__/common/script/qrcode.min.js"></script>
<style>
    .register-qrode-img img{width: 100%;}
</style>
</head>

<body>
<div class="white padding-tt-15">
	<div class="w1200 over">
	<div class="over">
		<div class="left margin-right-10">
			<img src="__static__/portal/img/logo.png" alt="" >
			<div class="center margin-5 grey-text text-darken-2">开创智慧新商业</div>
		</div>
		<div class="login-ti-border-left left grey-text text-ligthen-1 font-size-20 padding-10 margin-5">欢迎注册</div>
    </div>
    <div class="right">
        <span class="grey-text font-size-14">已有账号？</span>
        <span class="blue-text font-size-14 bt" onclick="goto('login')" >请登录></span>
    </div>
	</div>
</div>
<div class="w1200 margin-tt-15 white" id="app">
	<div class="over regoster-content">
        <div class="left black-text">
            <div class="flex margin-tt-10">
                <div class="register-input-set ">手机号码：</div>
                <div class="flex1 register-border ">
                    <input type="text" onkeyup="value=value.replace(/[^\d]/g,'')" v-model="register.mobile">
                </div>
            </div>
          <!--   <div class="flex">
                    <div class="register-input-set"></div>
                    <div class="flex1 red-text">
                       该账号已被注册
                    </div>
            </div> -->
            <div class="flex margin-tt-10">
                    <div class="register-input-set ">验证码：</div>
                    <div class="flex1 flex register-border margin-btn-10">
                        <input type="text" @keyup.enter="doRegister()" v-model="register.varicode">
                        <div class="padding-10 black-text grey lighten-2 getyanzh" onclick="sendVaricode(this,1);">获取验证码</div>
                    </div>
                </div>
                <div class="flex margin-tt-10">
                        <div class="register-input-set ">设置登陆密码：</div>
                        <div class="flex1 register-border margin-tt-10">
                            <input type="password" placeholder="密码要求必须大于6位"  v-model="register.password">
                        </div>
                </div>
                <div class="flex margin-tt-10">
                        <div class="register-input-set ">确认登陆密码：</div>
                        <div class="flex1 register-border margin-tt-10">
                            <input type="password" placeholder="再次输入密码"  v-model="register.repassword">
                        </div>
                </div>
                <div class="flex margin-tt-10">
                        <div class="register-input-set"></div>
                        <div class="flex1 grey-text text-ligthen-1">
                                <i class="iconfont icon-yuanxingweixuanzhong left margin-right-5 "@click="isTrues()" v-if="!isTrue"></i>
                                <i class="iconfont icon-roundcheckfill left margin-right-5 blue-text" @click="isTrues()" v-else ></i>
                           用户注册即是代表<span class="blue-text">《网开创 服务条例》</span>和<span class="blue-text">《网开创 服务条例》</span>
                        </div>
                </div>
                <div class="flex margin-tt-15">
                        <div class="register-input-set"></div>
                        <div class="flex1 blue white-text center font-size-16 padding-15" @click="doRegister()">
                          确认提交
                        </div>
                </div>
        </div>
        <div class="right center">
            <div class="register-qrode-img">
                <img src="__static__/portal/img/appios.png" alt="">
                下载ios版本app
            </div>
            <div class="register-qrode-img">
                    <img src="__static__/portal/img/appios.png" alt="">
                    下载安卓版本app
            </div>
            <div class="register-qrode-text black-text">
                扫描此二维码下载网开创手机版app吧！
            </div>
        </div>
    </div>
</div>
<div class="margin-top-15 padding-tt-15 center white">
	<div class="over black-text inline-black margin-tt-15 padding-top-15">
		<div class="left login-border-right margin-left-15  padding-right-15">关于我们</div>
		<div class="left login-border-right margin-left-15  padding-right-15">帮助中心</div>
		<div class="left login-border-right margin-left-15  padding-right-15">售后服务</div>
		<div class="left login-border-right margin-left-15 padding-right-15">配送于验收</div>
		<div class="left login-border-right margin-left-15 padding-right-15">关于我们</div>
		<div class="left login-border-right margin-left-15 padding-right-15">商务合作</div>
		<div class="left login-border-right margin-left-15 padding-right-15">联系方法</div>
		<div class="left login-border-right margin-left-15 padding-right-15">关于我们</div>
		<div class="left login-border-right margin-left-15 padding-right-15">关于我们</div>
	</div>
	<div class="black-text margin-tt-10">网络文化经营许可证：浙网文[2016]0155-055号 网开亿面公司版权所有©1997-2018 </div>
</div> 
</body>
<script>
	var app = new Vue({
		el: '#app',
		data: {
			login: {},
			register: {},
			reset: {},
			currentScene: 'login',
            isTrue:false,
		},
		methods: {
            isTrues:function(){
                this.isTrue = !this.isTrue;
            },
			doRegister: function () {

				if (this.register.mobile == '' || !variTelephone(this.register.mobile)) {
					layer.msg('请填写正确的手机号')
					return;
				} 
				if (this.register.password == '' || this.register.password == undefined || this.register.password == null) {
					layer.msg('请填写密码')
					return;
				}  
				if (!variPassword(this.register.password)) {
					layer.msg('密码限制6-20位大小写字母数字组合');
					return;
				}
				if (this.register.varicode == '' | this.register.varicode == undefined || this.register.varicode == null) {
					layer.msg('请填写验证码')
					return;
				} 
				if (this.register.password !== this.register.repassword) {
					layer.msg('两次输入密码不一致')
					this.reset.repassword = '';
					return;
				}
                if (!this.isTrue) {
					layer.msg('请勾选我同意')
					return;
				}
				var data = {
		            // reco_mobile: this.reco_mobile || '',
		            mobile: this.register.mobile,
		            password: this.register.password,
		            code: this.register.varicode,
		          }
				httpRequest('POST', 'api_users/user_accounts/register', data)
	            .then(function (resp) {
	              layer.msg(resp.msg)
	              resp.data.user.avatar = resp.data.user.avatar || '__static__/images/avatar.png';
	              user = resp.data.user;
	              token = resp.data.token;
	              setStorage(getClientType() + 'User', resp.data.user);
	              setStorage(getClientType() + 'Token', resp.data.token);
	              layer.msg(resp.msg);
	              setTimeout(function () {
	               goto('login')
	              }, 1000)
	            }) 
			},  
		}
	})

	 sendVaricode = function (evn, type) {
      var mobile =    app.register.mobile ;
      if (!variTelephone(mobile)) {
        layer.msg('请填写正确的手机号码')
        return;
      }
      httpRequest('POST', 'api_systems/helper/send_code', {
        mobile: mobile,
        type: type
      }).then(function (resp) {
        layer.msg(resp.msg)
        if (resp.code == 1) {
          sendclick(evn);
        }
      })
    }

    wait = 90;
    sendclick = function (evn) {
      var obj = $(evn);
      if (wait == 0) {
        obj.attr('disabled', false);
        obj.text('获取验证码');
        obj.css('backgroundColor', '#358cff');
        wait = 60;
      } else {
        obj.css('backgroundColor', '#696969');
        obj.attr('disabled', true);
        obj.text(wait + '秒再次发送');
        wait--;
        setTimeout(function () {
          sendclick(evn);
        }, 1000);
        
      }
    }
    new QRCode(document.getElementById("my_qu"), "http://192.168.1.116:81/portal");
</script>
</html>